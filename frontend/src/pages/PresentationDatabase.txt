  const databaseImplementations = {
    mongodb: {
      title: 'ğŸƒ MongoDB - Aggregation & Analytics',
      description: 'Advanced healthcare data analytics with MongoDB pipelines',
      realWorldUse: [
        'ğŸ“Š Patient cohort analysis - group by demographics, conditions',
        'ğŸ’Š Drug efficacy studies - aggregate treatment outcomes',
        'ğŸ¥ Hospital performance metrics - real-time analytics dashboards',
        'ğŸ“ˆ Predictive analytics - identify at-risk patients early'
      ],
      concepts: [
        'Aggregation Pipelines - $match, $group, $project, $lookup',
        'GridFS - Medical image storage (X-rays, MRIs, CT scans)',
        'Sharding - Horizontal scaling for 100M+ patient records',
        'Change Streams - Real-time data synchronization'
      ],
      demo: `=== MONGODB HEALTHCARE ANALYTICS ===

ğŸ“Š Sample Patient Collection:
  { "_id": "P001", "age": 25, "condition": "Hypertension", "visits": 5 }
  { "_id": "P002", "age": 45, "condition": "Diabetes", "visits": 8 }
  { "_id": "P003", "age": 15, "condition": "Asthma", "visits": 3 }
  { "_id": "P004", "age": 70, "condition": "Heart Disease", "visits": 12 }
  { "_id": "P005", "age": 35, "condition": "Migraine", "visits": 4 }

ğŸ” Aggregation Pipeline Example:

db.patients.aggregate([
  // Stage 1: Match active patients (last 90 days)
  {
    $match: {
      status: "active",
      lastVisit: { $gte: ISODate("2024-10-01") }
    }
  },
  
  // Stage 2: Add computed age group field
  {
    $addFields: {
      ageGroup: {
        $switch: {
          branches: [
            { case: { $lt: ["$age", 18] }, then: "Child" },
            { case: { $lt: ["$age", 40] }, then: "Adult" },
            { case: { $lt: ["$age", 65] }, then: "Middle Age" }
          ],
          default: "Senior"
        }
      }
    }
  },
  
  // Stage 3: Group by age group
  {
    $group: {
      _id: "$ageGroup",
      totalPatients: { $sum: 1 },
      avgAge: { $avg: "$age" },
      totalVisits: { $sum: "$visits" },
      conditions: { $push: "$condition" }
    }
  },
  
  // Stage 4: Sort by patient count
  { $sort: { totalPatients: -1 } }
])

âœ… AGGREGATION RESULTS:

Age Group Analysis:
  Adult: 2 patients, Avg Age: 30, Total Visits: 9
  Senior: 1 patient, Avg Age: 70, Total Visits: 12
  Middle Age: 1 patient, Avg Age: 45, Total Visits: 8
  Child: 1 patient, Avg Age: 15, Total Visits: 3

ğŸ“‚ GridFS Medical Image Storage:

// Store X-ray image
const bucket = new GridFSBucket(db, {
  bucketName: 'medicalImages',
  chunkSizeBytes: 255 * 1024 // 255KB chunks
});

bucket.upload({
  filename: 'patient_P001_xray_chest.dcm',
  metadata: {
    patientId: 'P001',
    scanType: 'X-Ray',
    bodyPart: 'Chest',
    timestamp: ISODate("2025-01-06"),
    aiAnalysisStatus: 'pending'
  }
});

âœ… Image stored in 255KB chunks for efficient streaming

ğŸ“ˆ Performance Metrics:
  â€¢ Aggregation: 120ms for 100K records
  â€¢ GridFS Upload: 2.3s for 50MB DICOM file
  â€¢ Sharded Query: 45ms across 10 nodes
  â€¢ Change Stream Latency: <100ms

ğŸ¥ Real Impact:
  âœ“ Analyze millions of patient records in seconds
  âœ“ Store unlimited medical images with metadata
  âœ“ Real-time dashboards for hospital administrators
  âœ“ Predictive analytics for preventive care`
    },

    firebase: {
      title: 'ğŸ”¥ Firebase - Real-time Sync',
      description: 'Real-time healthcare notifications and data synchronization',
      realWorldUse: [
        'âš¡ Real-time patient monitoring - vital signs updates',
        'ğŸš¨ Emergency alerts - instant notifications to on-call doctors',
        'ğŸ’¬ Doctor-patient messaging - HIPAA-compliant chat',
        'ğŸ“± Mobile app sync - offline support with automatic sync'
      ],
      concepts: [
        'Firestore Real-time Listeners - onSnapshot() for live data',
        'Cloud Functions - Server-side logic & triggers',
        'Firebase Cloud Messaging - Push notifications',
        'Security Rules - Fine-grained access control'
      ],
      demo: `=== FIREBASE REAL-TIME HEALTHCARE ===

ğŸ“Š Firestore Data Model:

patients/{patientId}
  â”œâ”€ personalInfo: { name, age, insurance }
  â”œâ”€ vitalSigns: { bp, hr, temp, timestamp }
  â”œâ”€ medications: [ {...}, {...} ]
  â””â”€ appointments: [ {...}, {...} ]

ğŸ”„ Real-time Patient Monitoring:

// Setup real-time listener
const unsubscribe = onSnapshot(
  doc(db, 'patients', 'P001'),
  (snapshot) => {
    const data = snapshot.data();
    const vitals = data.vitalSigns;
    
    // Check for critical conditions
    if (vitals.systolic > 180 || vitals.diastolic > 110) {
      // Trigger emergency alert
      sendEmergencyAlert({
        type: 'CRITICAL',
        message: 'Severe Hypertension Detected',
        patientId: 'P001',
        vitals: vitals
      });
    }
    
    // Update dashboard in real-time
    updateDashboard(data);
  }
);

âœ… Live Monitoring Active:
  ğŸ“ Patient P001 - Monitoring active
  ğŸ“Š BP: 140/90, HR: 85, Temp: 98.6Â°F
  âœ… All vitals within normal range
  âš¡ Last update: 2 seconds ago

ğŸš¨ Emergency Alert System:

exports.sendEmergencyAlert = functions.firestore
  .document('alerts/{alertId}')
  .onCreate(async (snap, context) => {
    const alert = snap.data();
    
    // Send to on-call doctor
    await admin.messaging().send({
      token: doctorDeviceToken,
      notification: {
        title: 'ğŸš¨ CRITICAL ALERT',
        body: \`Patient \${alert.patientId}: \${alert.message}\`
      },
      data: {
        type: 'emergency',
        patientId: alert.patientId,
        vitals: JSON.stringify(alert.vitals)
      }
    });
    
    // Log to audit trail
    await db.collection('auditLogs').add({
      event: 'emergency_alert_sent',
      timestamp: FieldValue.serverTimestamp(),
      ...alert
    });
  });

âœ… Alert Sent:
  ğŸ“± Dr. Smith notified
  â±ï¸ Response time: 1.2 seconds
  âœ“ Audit log created

ğŸ¤– AI Analysis Integration:

exports.analyzeM edicalScan = functions.https.onCall(
  async (data, context) => {
    const { scanId, scanType, patientId } = data;
    
    // Get scan image from Storage
    const imageUrl = await storage
      .bucket()
      .file(\`scans/\${scanId}.dcm\`)
      .getSignedUrl();
    
    // Call AI model
    const aiResult = await aiModel.analyze({
      imageUrl,
      scanType,
      priority: 'high'
    });
    
    // Store results
    await db.collection('aiAnalysisResults').add({
      scanId,
      patientId,
      scanType,
      findings: aiResult.findings,
      confidence: aiResult.confidence,
      timestamp: FieldValue.serverTimestamp(),
      status: 'completed'
    });
    
    return { success: true, analysisId: result.id };
  }
);

âœ… AI Analysis Complete:
  ğŸ” Scan Type: Chest X-Ray
  ğŸ§  Processing Time: 2.3 seconds
  âœ“ Findings: No acute abnormalities
  ğŸ“Š Confidence: 96.8%

ğŸ“ˆ Performance Metrics:
  â€¢ Real-time Latency: 45-120ms
  â€¢ Cloud Function Cold Start: 1.2s
  â€¢ Cloud Function Warm: 95ms
  â€¢ Push Notification Delivery: 2.1s avg
  â€¢ Offline Sync: Automatic on reconnect

ğŸ¥ Real Impact:
  âœ“ Instant alerts save lives in emergencies
  âœ“ Doctors access patient data from anywhere
  âœ“ Real-time collaboration between specialists
  âœ“ Mobile apps work offline, sync automatically`
    }
  };
